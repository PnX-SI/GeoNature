<!doctype html>
<html class="no-js" lang="fr" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Recherche" href="search.html" /><link rel="next" title="Manuel utilisateur" href="user-manual.html" /><link rel="prev" title="Bienvenue dans la documentation de GeoNature" href="index.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Installation - Documentation GeoNature 2.15.4</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Documentation GeoNature 2.15.4</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/LogoGeonature.jpg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation GeoNature 2.15.4</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-manual.html">Manuel utilisateur</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin-manual.html">Manuel administrateur</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Développement</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Auteurs</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">CHANGELOG</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api-references.html">API REFERENCES</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API REFERENCES</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="autoapi/geonature/index.html">geonature</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of geonature</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="autoapi/geonature/app/index.html">geonature.app</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/geonature/core/index.html">geonature.core</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of geonature.core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/admin/index.html">geonature.core.admin</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of geonature.core.admin</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/admin/admin/index.html">geonature.core.admin.admin</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/admin/utils/index.html">geonature.core.admin.utils</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/command/index.html">geonature.core.command</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of geonature.core.command</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/command/__main__/index.html">geonature.core.command.__main__</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/command/create_gn_module/index.html">geonature.core.command.create_gn_module</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/command/main/index.html">geonature.core.command.main</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/core/errors/index.html">geonature.core.errors</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_commons/index.html">geonature.core.gn_commons</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of geonature.core.gn_commons</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_commons/admin/index.html">geonature.core.gn_commons.admin</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_commons/medias/index.html">geonature.core.gn_commons.medias</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of geonature.core.gn_commons.medias</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_commons/medias/routes/index.html">geonature.core.gn_commons.medias.routes</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_commons/models/index.html">geonature.core.gn_commons.models</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of geonature.core.gn_commons.models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_commons/models/additional_fields/index.html">geonature.core.gn_commons.models.additional_fields</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_commons/models/base/index.html">geonature.core.gn_commons.models.base</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_commons/repositories/index.html">geonature.core.gn_commons.repositories</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_commons/routes/index.html">geonature.core.gn_commons.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_commons/schemas/index.html">geonature.core.gn_commons.schemas</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_commons/tasks/index.html">geonature.core.gn_commons.tasks</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_commons/validation/index.html">geonature.core.gn_commons.validation</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of geonature.core.gn_commons.validation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_commons/validation/routes/index.html">geonature.core.gn_commons.validation.routes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_meta/index.html">geonature.core.gn_meta</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of geonature.core.gn_meta</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_meta/models/index.html">geonature.core.gn_meta.models</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of geonature.core.gn_meta.models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_meta/models/aframework/index.html">geonature.core.gn_meta.models.aframework</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_meta/models/commons/index.html">geonature.core.gn_meta.models.commons</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_meta/models/datasets/index.html">geonature.core.gn_meta.models.datasets</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_meta/repositories/index.html">geonature.core.gn_meta.repositories</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_meta/routes/index.html">geonature.core.gn_meta.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_meta/schemas/index.html">geonature.core.gn_meta.schemas</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_monitoring/index.html">geonature.core.gn_monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of geonature.core.gn_monitoring</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_monitoring/models/index.html">geonature.core.gn_monitoring.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_monitoring/routes/index.html">geonature.core.gn_monitoring.routes</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/index.html">geonature.core.gn_permissions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of geonature.core.gn_permissions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/admin/index.html">geonature.core.gn_permissions.admin</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/commands/index.html">geonature.core.gn_permissions.commands</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/decorators/index.html">geonature.core.gn_permissions.decorators</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/models/index.html">geonature.core.gn_permissions.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/routes/index.html">geonature.core.gn_permissions.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/schemas/index.html">geonature.core.gn_permissions.schemas</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_permissions/tools/index.html">geonature.core.gn_permissions.tools</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_profiles/index.html">geonature.core.gn_profiles</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of geonature.core.gn_profiles</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_profiles/models/index.html">geonature.core.gn_profiles.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_profiles/routes/index.html">geonature.core.gn_profiles.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_profiles/tasks/index.html">geonature.core.gn_profiles.tasks</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/index.html">geonature.core.gn_synthese</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of geonature.core.gn_synthese</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/imports/index.html">geonature.core.gn_synthese.imports</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of geonature.core.gn_synthese.imports</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/imports/actions/index.html">geonature.core.gn_synthese.imports.actions</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/imports/geo/index.html">geonature.core.gn_synthese.imports.geo</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/imports/plot/index.html">geonature.core.gn_synthese.imports.plot</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/models/index.html">geonature.core.gn_synthese.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/module/index.html">geonature.core.gn_synthese.module</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/routes/index.html">geonature.core.gn_synthese.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/schemas/index.html">geonature.core.gn_synthese.schemas</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/synthese_config/index.html">geonature.core.gn_synthese.synthese_config</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/utils/index.html">geonature.core.gn_synthese.utils</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of geonature.core.gn_synthese.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/utils/blurring/index.html">geonature.core.gn_synthese.utils.blurring</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/utils/orm/index.html">geonature.core.gn_synthese.utils.orm</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/utils/process/index.html">geonature.core.gn_synthese.utils.process</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/gn_synthese/utils/query_select_sqla/index.html">geonature.core.gn_synthese.utils.query_select_sqla</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/imports/index.html">geonature.core.imports</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of geonature.core.imports</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/actions/index.html">geonature.core.imports.actions</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/admin/index.html">geonature.core.imports.admin</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/blueprint/index.html">geonature.core.imports.blueprint</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/imports/checks/index.html">geonature.core.imports.checks</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of geonature.core.imports.checks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6 has-children"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/index.html">geonature.core.imports.checks.dataframe</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of geonature.core.imports.checks.dataframe</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/cast/index.html">geonature.core.imports.checks.dataframe.cast</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/core/index.html">geonature.core.imports.checks.dataframe.core</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/dates/index.html">geonature.core.imports.checks.dataframe.dates</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/geometry/index.html">geonature.core.imports.checks.dataframe.geometry</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/dataframe/utils/index.html">geonature.core.imports.checks.dataframe.utils</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/imports/checks/errors/index.html">geonature.core.imports.checks.errors</a></li>
<li class="toctree-l6 has-children"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/index.html">geonature.core.imports.checks.sql</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of geonature.core.imports.checks.sql</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/core/index.html">geonature.core.imports.checks.sql.core</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/extra/index.html">geonature.core.imports.checks.sql.extra</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/geo/index.html">geonature.core.imports.checks.sql.geo</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/nomenclature/index.html">geonature.core.imports.checks.sql.nomenclature</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/parent/index.html">geonature.core.imports.checks.sql.parent</a></li>
<li class="toctree-l7"><a class="reference internal" href="autoapi/geonature/core/imports/checks/sql/utils/index.html">geonature.core.imports.checks.sql.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/commands/index.html">geonature.core.imports.commands</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/config_schema/index.html">geonature.core.imports.config_schema</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/logs/index.html">geonature.core.imports.logs</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/models/index.html">geonature.core.imports.models</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="autoapi/geonature/core/imports/routes/index.html">geonature.core.imports.routes</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of geonature.core.imports.routes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/imports/routes/fields/index.html">geonature.core.imports.routes.fields</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/imports/routes/imports/index.html">geonature.core.imports.routes.imports</a></li>
<li class="toctree-l6"><a class="reference internal" href="autoapi/geonature/core/imports/routes/mappings/index.html">geonature.core.imports.routes.mappings</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/schemas/index.html">geonature.core.imports.schemas</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/tasks/index.html">geonature.core.imports.tasks</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/templates/index.html">geonature.core.imports.templates</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/imports/utils/index.html">geonature.core.imports.utils</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/notifications/index.html">geonature.core.notifications</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of geonature.core.notifications</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/notifications/admin/index.html">geonature.core.notifications.admin</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/notifications/models/index.html">geonature.core.notifications.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/notifications/routes/index.html">geonature.core.notifications.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/notifications/tasks/index.html">geonature.core.notifications.tasks</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/notifications/utils/index.html">geonature.core.notifications.utils</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/sensitivity/index.html">geonature.core.sensitivity</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of geonature.core.sensitivity</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/sensitivity/models/index.html">geonature.core.sensitivity.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/sensitivity/routes/index.html">geonature.core.sensitivity.routes</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/sensitivity/utils/index.html">geonature.core.sensitivity.utils</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/taxonomie/index.html">geonature.core.taxonomie</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of geonature.core.taxonomie</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/taxonomie/admin/index.html">geonature.core.taxonomie.admin</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/taxonomie/schemas/index.html">geonature.core.taxonomie.schemas</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/geonature/core/users/index.html">geonature.core.users</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of geonature.core.users</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/users/models/index.html">geonature.core.users.models</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/users/register_post_actions/index.html">geonature.core.users.register_post_actions</a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/geonature/core/users/routes/index.html">geonature.core.users.routes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/geonature/middlewares/index.html">geonature.middlewares</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/geonature/tasks/index.html">geonature.tasks</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/geonature/utils/index.html">geonature.utils</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of geonature.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/celery/index.html">geonature.utils.celery</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/command/index.html">geonature.utils.command</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/config/index.html">geonature.utils.config</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/config_schema/index.html">geonature.utils.config_schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/env/index.html">geonature.utils.env</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/errors/index.html">geonature.utils.errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/filemanager/index.html">geonature.utils.filemanager</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/logs/index.html">geonature.utils.logs</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/metaclass_utils/index.html">geonature.utils.metaclass_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/module/index.html">geonature.utils.module</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/schema/index.html">geonature.utils.schema</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/sentry/index.html">geonature.utils.sentry</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/utilsgeometrytools/index.html">geonature.utils.utilsgeometrytools</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/utilsmails/index.html">geonature.utils.utilsmails</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/utilsrequests/index.html">geonature.utils.utilsrequests</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/geonature/utils/utilstoml/index.html">geonature.utils.utilstoml</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/installation.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Lien vers cette rubrique">¶</a></h1>
<p>GeoNature repose sur les composants suivants :</p>
<ul class="simple">
<li><p>PostgreSQL / PostGIS</p></li>
<li><p>Python 3 et dépendances Python nécessaires à l’application</p></li>
<li><p>Flask (framework web Python)</p></li>
<li><p>Apache</p></li>
<li><p>Angular 15, Angular CLI, NodeJS</p></li>
<li><p>Librairies javascript (Leaflet, ChartJS)</p></li>
<li><p>Librairies CSS (Bootstrap, Material Design)</p></li>
</ul>
<p>Deux méthodes d’installation existent :</p>
<ul class="simple">
<li><p><a class="reference internal" href="#installation-all"><span class="std std-ref">Installation globale</span></a> : Installation automatisée de GeoNature (incluant TaxHub) et UsersHub.</p></li>
<li><p><a class="reference internal" href="#installation-standalone"><span class="std std-ref">Installation de GeoNature uniquement</span></a> : UsersHub n’est pas installé (mais son schéma de BDD est tout de même créé dans la base de données de GeoNature).</p></li>
</ul>
<section id="prerequis">
<h2>Prérequis<a class="headerlink" href="#prerequis" title="Lien vers cette rubrique">¶</a></h2>
<ul class="simple">
<li><p>Ressources minimum serveur :</p>
<ul>
<li><p>Un serveur Debian 11 ou 12, architecture 64-bits</p></li>
<li><p>4 Go RAM</p></li>
<li><p>20 Go d’espace disque</p></li>
</ul>
</li>
<li><p>GeoNature nécessite d’accéder à des ressources externes durant son installation et son fonctionnement. Si vous utilisez un serveur mandataire, celui-ci doit permettre l’accès aux domaines suivants :</p>
<ul>
<li><p><a class="reference external" href="https://pypi.python.org">https://pypi.python.org</a></p></li>
<li><p><a class="reference external" href="https://geonature.fr/">https://geonature.fr/</a></p></li>
<li><p><a class="reference external" href="https://codeload.github.com/">https://codeload.github.com/</a></p></li>
<li><p><a class="reference external" href="https://nodejs.org/dist">https://nodejs.org/dist</a></p></li>
<li><p><a class="reference external" href="https://registry.npmjs.org">https://registry.npmjs.org</a></p></li>
<li><p><a class="reference external" href="https://www.npmjs.com">https://www.npmjs.com</a></p></li>
<li><p><a class="reference external" href="https://raw.githubusercontent.com/">https://raw.githubusercontent.com/</a></p></li>
<li><p><a class="reference external" href="https://data.geopf.fr/">https://data.geopf.fr/</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="preparation-du-serveur">
<span id="preparation-server"></span><h2>Préparation du serveur<a class="headerlink" href="#preparation-du-serveur" title="Lien vers cette rubrique">¶</a></h2>
<p>Commencer la procédure en se connectant au serveur en SSH avec l’utilisateur linux <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<ul>
<li><p>Mettre à jour de la liste des dépôts Linux :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>apt<span class="w"> </span>update
apt<span class="w"> </span>upgrade
</pre></div>
</div>
</li>
<li><p>Configuration de la locale du serveur</p>
<p>Certains serveurs sont livrés sans « locale » (langue par défaut). Pour l’installation de GeoNature, il est nécessaire de bien configurer la locale. Si la commande <code class="docutils literal notranslate"><span class="pre">locale</span></code> renvoie ceci :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">LANG=fr_FR.UTF-8</span>
<span class="go">LANGUAGE=fr_FR.UTF-8</span>
<span class="go">LC_CTYPE=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_NUMERIC=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_TIME=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_COLLATE=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_MONETARY=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_MESSAGES=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_PAPER=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_NAME=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_ADDRESS=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_TELEPHONE=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_MEASUREMENT=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_IDENTIFICATION=&quot;fr_FR.UTF-8&quot;</span>
<span class="go">LC_ALL=fr_FR.UTF-8</span>
</pre></div>
</div>
<p>Vous pouvez alors passer cette étape de configuration des locales.</p>
<p>Sinon exécuter la commande <code class="docutils literal notranslate"><span class="pre">dpkg-reconfigure</span> <span class="pre">locales</span></code>. Une fenêtre s’affiche dans votre console. Dans la liste déroulante, sélectionnez <code class="docutils literal notranslate"><span class="pre">fr_FR.UTF-8</span> <span class="pre">UTF-8</span></code> avec <code class="docutils literal notranslate"><span class="pre">Espace</span></code>, puis cliquez sur OK. Une 2ème fenêtre s’affiche avec une liste de locale activées (<code class="docutils literal notranslate"><span class="pre">fr_FR.UTF-8</span></code> doit être présent dans la liste), confirmez votre choix, en cliquant sur OK, puis attendez que la locale s’installe.</p>
</li>
<li><p>Installer l’utilitaire <code class="docutils literal notranslate"><span class="pre">sudo</span></code> :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>apt<span class="w"> </span>install<span class="w"> </span>sudo
</pre></div>
</div>
</li>
<li><p>Créer un utilisateur Linux dédié (nommé <code class="docutils literal notranslate"><span class="pre">geonatureadmin</span></code> dans notre cas) pour ne pas travailler en <code class="docutils literal notranslate"><span class="pre">root</span></code> :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>adduser<span class="w"> </span>geonatureadmin
</pre></div>
</div>
</li>
<li><p>Lui donner ensuite les droits administrateur en l’ajoutant au groupe <code class="docutils literal notranslate"><span class="pre">sudo</span></code> :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>adduser<span class="w"> </span>geonatureadmin<span class="w"> </span>sudo
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vérifier les droits du répertoire HOME de l’utilisateur</p>
<p>Il doit être en <code class="docutils literal notranslate"><span class="pre">7XX</span></code> soit <code class="docutils literal notranslate"><span class="pre">drwxr-xr-x</span></code>. Si ce n’est pas le cas, exécuter la commande suivante :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>/home/geonatureadmin
</pre></div>
</div>
</div>
<ul>
<li><p>Pour la suite du processus d’installation, on utilisera l’utilisateur non privilégié nouvellement créé. Si besoin d’éxecuter des commandes avec les droits d’administrateur, on les précèdera de <code class="docutils literal notranslate"><span class="pre">sudo</span></code>.</p>
<p>Il est d’ailleurs possible renforcer la sécurité du serveur en bloquant la connexion SSH au serveur avec <code class="docutils literal notranslate"><span class="pre">root</span></code>. Voir <a class="reference external" href="https://docs.ovh.com/fr/vps/conseils-securisation-vps/">https://docs.ovh.com/fr/vps/conseils-securisation-vps/</a> pour plus d’informations sur le sécurisation du serveur.</p>
<p>Pour passer de l’utilisateur <code class="docutils literal notranslate"><span class="pre">root</span></code> à <code class="docutils literal notranslate"><span class="pre">geonatureadmin</span></code>, vous pouvez aussi utiliser la commande :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>su<span class="w"> </span>-<span class="w"> </span>geonatureadmin
</pre></div>
</div>
</li>
</ul>
</section>
<section id="installation-globale">
<span id="installation-all"></span><h2>Installation globale<a class="headerlink" href="#installation-globale" title="Lien vers cette rubrique">¶</a></h2>
<p>Ce document décrit une procédure d’installation packagée de GeoNature.</p>
<p>En lançant le script d’installation ci-dessous, l’application GeoNature ainsi que ses dépendances seront installées sur un seul et même serveur au sein d’une seule base de données.</p>
<p>Les applications suivantes seront installées :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/PnX-SI/GeoNature">GeoNature</a> (incluant <a class="reference external" href="https://github.com/PnX-SI/TaxHub">TaxHub</a> qui pilote le schéma <code class="docutils literal notranslate"><span class="pre">taxonomie</span></code>)</p></li>
<li><p><a class="reference external" href="https://github.com/PnX-SI/UsersHub">UsersHub</a> qui pilote le schéma <code class="docutils literal notranslate"><span class="pre">utilisateurs</span></code> (le paramètre <code class="docutils literal notranslate"><span class="pre">install_usershub_app</span></code> du fichier de configuration <code class="docutils literal notranslate"><span class="pre">install_all.ini</span></code> permet de désactiver l’installation de l’application. Il est cependant recommandé d’installer l’application pour disposer d’une interface pour gérer les utilisateurs dans GeoNature)</p></li>
</ul>
<p>Si vous disposez déjà de UsersHub sur un autre serveur ou une autre base de données et que vous souhaitez installer simplement GeoNature, veuillez suivre la documentation <a class="reference internal" href="#installation-standalone"><span class="std std-ref">Installation de GeoNature uniquement</span></a>.</p>
<section id="installation-des-applications">
<h3>Installation des applications<a class="headerlink" href="#installation-des-applications" title="Lien vers cette rubrique">¶</a></h3>
<p>Commencer la procédure en se connectant au serveur en SSH avec l’utilisateur dédié précédemment créé lors de l’étape de <a class="reference internal" href="#preparation-server"><span class="std std-ref">Préparation du serveur</span></a> (usuellement <code class="docutils literal notranslate"><span class="pre">geonatureadmin</span></code>).</p>
<section id="telechargement">
<h4>Téléchargement<a class="headerlink" href="#telechargement" title="Lien vers cette rubrique">¶</a></h4>
<ul>
<li><p>Se placer à la racine du <code class="docutils literal notranslate"><span class="pre">home</span></code> de l’utilisateur puis récupérer les scripts d’installation (X.Y.Z à remplacer par le numéro de la <a class="reference external" href="https://github.com/PnEcrins/GeoNature/releases">dernière version stable de GeoNature</a>). Ces scripts installent les applications GeoNature (incluant TaxHub) et UsersHub (en option) ainsi que leurs bases de données (uniquement les schémas du coeur) :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">wget https://raw.githubusercontent.com/PnX-SI/GeoNature/X.Y.Z/install/install_all/install_all.ini</span>
<span class="go">wget https://raw.githubusercontent.com/PnX-SI/GeoNature/X.Y.Z/install/install_all/install_all.sh</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>L’installation globale fonctionne uniquement si les scripts sont placés à la racine du <code class="docutils literal notranslate"><span class="pre">home</span></code> de l’utilisateur courant.</p>
</div>
</section>
<section id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Lien vers cette rubrique">¶</a></h4>
<ul>
<li><p>Configurez votre installation en adaptant le fichier <code class="docutils literal notranslate"><span class="pre">install_all.ini</span></code> :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nano install_all.ini</span>
</pre></div>
</div>
</li>
<li><p>Renseignez à minima :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">my_url</span></code> : l’URL (ou IP) de votre serveur (avec un <code class="docutils literal notranslate"><span class="pre">/</span></code> à la fin)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_pg</span></code> : l’utilisateur PostgreSQL que vous souhaitez voir créé</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_pg_pass</span></code> : mot de passe de l’utilisateur PostgreSQL</p></li>
</ul>
<p>Le script se chargera d’installer PostgreSQL, de crééer la base de donnée et de créer l’utilisateur que vous avez renseigné.</p>
</li>
<li><p>Variable <code class="docutils literal notranslate"><span class="pre">mode</span></code></p></li>
</ul>
<p>Pour l’installation d’une instance de production ou de test <code class="docutils literal notranslate"><span class="pre">mode=prod</span></code>, pour une installation de développement <code class="docutils literal notranslate"><span class="pre">mode=dev</span></code>.</p>
<p><strong>Il est déconseillé de modifier les numéros de version des dépendances, chaque nouvelle version de GeoNature étant fournie avec les versions adaptées de ses dépendances.</strong></p>
</section>
<section id="id1">
<h4>Installation<a class="headerlink" href="#id1" title="Lien vers cette rubrique">¶</a></h4>
<p>Lancer l’installation à l’aide des commandes suivantes :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>touch<span class="w"> </span>install_all.log
chmod<span class="w"> </span>+x<span class="w"> </span>install_all.sh
./install_all.sh<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>install_all.log
</pre></div>
</div>
<p>Une fois l’installation terminée, lancez la commande suivante:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">exec</span><span class="w"> </span>bash
</pre></div>
</div>
<p>Les applications sont disponibles aux adresses suivantes :</p>
<ul class="simple">
<li><p><a class="reference external" href="http://monip.com/geonature/">http://monip.com/geonature/</a></p></li>
<li><p><a class="reference external" href="http://monip.com/usershub/">http://monip.com/usershub/</a> (en option)</p></li>
</ul>
<p>Vous pouvez vous connecter avec l’utilisateur intégré par défaut (admin/admin).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour en savoir plus TaxHub, sa configuration et son utilisation, reportez-vous à sa documentation : <a class="reference external" href="https://taxhub.readthedocs.io">https://taxhub.readthedocs.io</a>. Idem pour UsersHub et sa documentation : <a class="reference external" href="https://usershub.readthedocs.io">https://usershub.readthedocs.io</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>GeoNature-atlas compatible avec GeoNature V2 est disponible sur <a class="reference external" href="https://github.com/PnX-SI/GeoNature-atlas">https://github.com/PnX-SI/GeoNature-atlas</a></p></li>
<li><p>Vous pouvez utiliser le schéma <code class="docutils literal notranslate"><span class="pre">ref_geo</span></code> de GeoNature pour votre territoire, les communes et les mailles.</p></li>
</ul>
</div>
<p>Si vous rencontrez une erreur, se reporter aux fichiers de logs <code class="docutils literal notranslate"><span class="pre">/home/`whoami`/install_all.log</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Si vous souhaitez que GeoNature soit à la racine du serveur, ou à une autre adresse, editez le fichier de configuration Apache (<code class="docutils literal notranslate"><span class="pre">/etc/apache2/sites-available/geonature.conf</span></code>) en modifiant l’alias :</p>
<ul class="simple">
<li><p>Pour <code class="docutils literal notranslate"><span class="pre">/</span></code>: <code class="docutils literal notranslate"><span class="pre">Alias</span> <span class="pre">/</span> <span class="pre">/home/test/geonature/frontend/dist</span></code></p></li>
<li><p>Pour <code class="docutils literal notranslate"><span class="pre">/saisie</span></code> : <code class="docutils literal notranslate"><span class="pre">Alias</span> <span class="pre">/saisie</span> <span class="pre">/home/test/geonature/frontend/dist</span></code></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Par défaut et par mesure de sécurité, la base de données est accessible uniquement localement par la machine où elle est installée. Pour accéder à la BDD depuis une autre machine (pour s’y connecter avec QGIS, pgAdmin ou autre), vous pouvez consulter cette documentation <a class="reference external" href="https://github.com/PnX-SI/Ressources-techniques/blob/master/PostgreSQL/acces-bdd.rst">https://github.com/PnX-SI/Ressources-techniques/blob/master/PostgreSQL/acces-bdd.rst</a>.
Attention, exposer la base de données sur internet n’est pas recommandé. Il est préférable de se connecter via un tunnel SSH. QGIS et la plupart des outils d’administration de base de données permettent d’établir une connexion à la base de cette manière.
Attention si vous redémarrez PostgreSQL (<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">postgresql</span> <span class="pre">restart</span></code>), il faut ensuite redémarrer les API de GeoNature et UsersHub :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature-worker
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>usershub
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il est aussi important de configurer l’accès au serveur en HTTPS plutôt qu’en HTTP pour chiffrer le contenu des échanges entre le navigateur et le serveur (<a class="reference external" href="https://docs.ovh.com/fr/hosting/les-certificats-ssl-sur-les-hebergements-web/">https://docs.ovh.com/fr/hosting/les-certificats-ssl-sur-les-hebergements-web/</a>).</p>
</div>
</section>
</section>
</section>
<section id="installation-de-geonature-uniquement">
<span id="installation-standalone"></span><h2>Installation de GeoNature uniquement<a class="headerlink" href="#installation-de-geonature-uniquement" title="Lien vers cette rubrique">¶</a></h2>
<p>Cette procédure détaille l’installation de GeoNature (incluant TaxHub) sans UsersHub.
Si vous souhaitez installer GeoNature avec UsersHub, reportez-vous à la section <a class="reference internal" href="#installation-all"><span class="std std-ref">Installation globale</span></a>.</p>
<section id="installation-des-dependances">
<h3>Installation des dépendances<a class="headerlink" href="#installation-des-dependances" title="Lien vers cette rubrique">¶</a></h3>
<p>Installer les paquets suivants :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>unzip<span class="w"> </span>git<span class="w"> </span>postgresql-postgis<span class="w"> </span>postgis<span class="w"> </span>python3-pip<span class="w"> </span>python3-venv<span class="w"> </span>python3-dev<span class="w"> </span>libpq-dev<span class="w"> </span>libgdal-dev<span class="w"> </span>libffi-dev<span class="w"> </span>libpangocairo-1.0-0<span class="w"> </span>apache2<span class="w"> </span>redis
</pre></div>
</div>
</section>
<section id="recuperation-de-l-application">
<h3>Récupération de l’application<a class="headerlink" href="#recuperation-de-l-application" title="Lien vers cette rubrique">¶</a></h3>
<ul>
<li><p>Se placer dans le répertoire de l’utilisateur (<code class="docutils literal notranslate"><span class="pre">/home/geonatureadmin/</span></code> dans notre cas)</p></li>
<li><p>Récupérer l’application (<code class="docutils literal notranslate"><span class="pre">X.Y.Z</span></code> à remplacer par le numéro de la <a class="reference external" href="https://github.com/PnEcrins/GeoNature/releases">dernière version stable de GeoNature</a>).</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/PnX-SI/GeoNature/archive/X.Y.Z.zip
</pre></div>
</div>
</li>
<li><p>Dézipper l’archive de l’application</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>unzip<span class="w"> </span>X.Y.Z.zip
rm<span class="w"> </span>X.Y.Z.zip
</pre></div>
</div>
</li>
<li><p>Renommer le répertoire de l’application puis placez-vous dedans :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>GeoNature-X.Y.Z<span class="w"> </span>/home/<span class="sb">`</span>whoami<span class="sb">`</span>/geonature/
<span class="nb">cd</span><span class="w"> </span>geonature
</pre></div>
</div>
</li>
<li><p>Copier puis mettre à jour le fichier de configuration (<code class="docutils literal notranslate"><span class="pre">config/settings.ini</span></code>) comportant les informations relatives à votre environnement serveur :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>config/settings.ini.sample<span class="w"> </span>config/settings.ini
nano<span class="w"> </span>config/settings.ini
</pre></div>
</div>
</li>
</ul>
</section>
<section id="installation-de-l-application">
<h3>Installation de l’application<a class="headerlink" href="#installation-de-l-application" title="Lien vers cette rubrique">¶</a></h3>
<p>Rendez vous dans le dossier <code class="docutils literal notranslate"><span class="pre">install</span></code> et lancez successivement dans l’ordre les scripts suivants :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">01_install_backend.sh</span></code> : Création du virtualenv python, installation des dépendances et du backend de GeoNature dans celui-ci.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">02_configure_systemd.sh</span></code> : Création des services systemd <code class="docutils literal notranslate"><span class="pre">geonature</span></code> et <code class="docutils literal notranslate"><span class="pre">geonature-worker</span></code>, configuration de <code class="docutils literal notranslate"><span class="pre">logrotate</span></code>, création des dossiers <code class="docutils literal notranslate"><span class="pre">/run/geonature</span></code> et <code class="docutils literal notranslate"><span class="pre">/var/log/geonature</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">03_create_db.sh</span></code> : Création du role PostgreSQL, de la base de données, ajout des extensions nécessaires (PostGIS, …), création des schémas nécessaires à GeoNature et ajout des données métiers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">04_install_gn_modules.sh</span></code> : Installation des modules Occtax, Occhab et Validation (si activé dans le fichier <cite>settings.ini</cite>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">05_install_frontend.sh</span></code> : Création des dossiers et liens symboliques nécessaires, création des fichiers custom à partir des fichiers d’exemple, génération des fichiers de configuration grâce à la commande <code class="docutils literal notranslate"><span class="pre">geonature</span></code>, installation de nvm, npm et node ainsi que toutes les dépendances javascript nécessaires puis build du frontend, génération du fichier <code class="docutils literal notranslate"><span class="pre">src/assets/config.json</span></code> qui permet de connecter le frontend au backend.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">06_configure_apache.sh</span></code> : Installation du fichier de configuration Apache <code class="docutils literal notranslate"><span class="pre">/etc/apache2/conf-available/geonature.conf</span></code> et activation des modules Apache nécessaires.</p></li>
</ul>
<p>Vous pouvez alors démarrer le backend de GeoNature : <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">systemctl</span> <span class="pre">start</span> <span class="pre">geonature</span></code></p>
</section>
<section id="configuration-apache">
<h3>Configuration Apache<a class="headerlink" href="#configuration-apache" title="Lien vers cette rubrique">¶</a></h3>
<ul>
<li><p>Le script <code class="docutils literal notranslate"><span class="pre">install/06_configure_apache.sh</span></code> copie le fichier de configuration de référence <code class="docutils literal notranslate"><span class="pre">install/assets/geonature_apache.conf</span></code>, le place dans <code class="docutils literal notranslate"><span class="pre">/etc/apache2/conf-available/geonature.conf</span></code> et remplace ses variables à partir de votre configuration de GeoNature.</p>
<p>Relancez ce script si vous changez l’URL de votre GeoNature ou les paramètres liés aux chemins et URL des fichiers statiques et des médias.</p>
</li>
<li><p>Créez la configuration du vhost, incluant la configuration par défaut créée précédemment :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cp<span class="w"> </span>install/assets/vhost_apache.conf<span class="w"> </span>/etc/apache2/sites-available/geonature.conf<span class="w"> </span><span class="c1"># Copier le vhost</span>
sudo<span class="w"> </span>nano<span class="w"> </span>/etc/apache2/sites-available/geonature.conf<span class="w"> </span><span class="c1"># Modifier la variable ``${DOMAIN_NAME}``</span>
</pre></div>
</div>
</li>
<li><p>Activez la nouvelle configuration :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>a2ensite<span class="w"> </span>geonature.conf
</pre></div>
</div>
</li>
<li><p>et redémarrez Apache :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>apache2
</pre></div>
</div>
</li>
<li><p>L’application est disponible à l’adresse suivante : <a class="reference external" href="http://monurl.fr/geonature">http://monurl.fr/geonature</a></p></li>
</ul>
<p>Une page HTML de maintenance et un vhost dédié sont aussi disponibles. Pour les mettre en place :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cp<span class="w"> </span>install/assets/vhost_apache_maintenance.conf<span class="w"> </span>/etc/apache2/sites-available/geonature_maintenance.conf<span class="w"> </span><span class="c1"># Copier le vhost</span>
sudo<span class="w"> </span>nano<span class="w"> </span>/etc/apache2/sites-available/geonature_maintenance.conf<span class="w"> </span><span class="c1"># Modifier la variable ``${DOMAIN_NAME}``</span>
sudo<span class="w"> </span>cp<span class="w"> </span>install/assets/maintenance.html<span class="w"> </span>/var/www/geonature_maintenance/index.html
</pre></div>
</div>
<p>Pour passer votre GeoNature en maintenance, vous pouvez alors désactiver le vhost de GeoNature et activer celui de la page de maintenance :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>a2dissite<span class="w"> </span>geonature.conf
sudo<span class="w"> </span>a2ensite<span class="w"> </span>geonature_maintenance.conf
</pre></div>
</div>
</section>
<section id="dependances">
<h3>Dépendances<a class="headerlink" href="#dependances" title="Lien vers cette rubrique">¶</a></h3>
<p>Lors de l’installation de la BDD (<code class="docutils literal notranslate"><span class="pre">02_create_db.sh</span></code>), le schéma <code class="docutils literal notranslate"><span class="pre">utilisateurs</span></code> de UsersHub et le schéma <code class="docutils literal notranslate"><span class="pre">taxonomie</span></code> de TaxHub sont intégrés automatiquement dans la BDD de GeoNature.</p>
<p>UsersHub n’est pas nécessaire au fonctionnement de GeoNature mais il sera utile pour avoir une interface de gestion des utilisateurs, des groupes et de leurs droits.</p>
<p>TaxHub v2 est intégré à GeoNature depuis sa version 2.15.0</p>
<p>Voir la documentation de TaxHub : <a class="reference external" href="https://taxhub.readthedocs.io/">https://taxhub.readthedocs.io/</a></p>
<p>Voir la doc d’installation de UsersHub : <a class="reference external" href="https://usershub.readthedocs.io/">https://usershub.readthedocs.io/</a></p>
</section>
<section id="passer-en-mode-developpement">
<h3>Passer en mode développement<a class="headerlink" href="#passer-en-mode-developpement" title="Lien vers cette rubrique">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consultez le guide <a class="reference internal" href="development.html#mode-dev"><span class="std std-ref">Passer en mode développement</span></a> de GeoNature.</p>
</div>
</section>
</section>
<section id="docker">
<h2>Docker<a class="headerlink" href="#docker" title="Lien vers cette rubrique">¶</a></h2>
<p>L’installation de GeoNature avec Docker est la manière la plus simple de déployer GeoNature, ses 4 modules externes principaux (Import, Export, Dashboard, Monitoring) et UsersHub, mais aussi de les mettre à jour, avec seulement quelques lignes de commandes.</p>
<p>Elle permet aussi d’installer GeoNature sur différents systèmes, et pas uniquement sur Debian, comme c’est le cas avec l’installation classique.</p>
<p>Elle peut néanmoins nécessiter de connaitre le fonctionnement de Docker pour ceux qui souhaitent aller plus loin et mettre en place une installation plus spécifique.</p>
<section id="docker-compose">
<h3>Docker Compose<a class="headerlink" href="#docker-compose" title="Lien vers cette rubrique">¶</a></h3>
<p>Pour déployer facilement GeoNature avec Docker, utilisez le Docker Compose proposé et documenté dans le dépôt <a class="reference external" href="https://github.com/PnX-SI/Geonature-Docker-services/">GeoNature-Docker-services</a>.</p>
<p>Pour des déploiements Docker plus avancés et spécifiques, des images Docker des différents outils (GeoNature, UsersHub, GeoNature et ses 4 modules externes principaux) sont automatiquement construites et publiées à chaque nouvelle version publiée.</p>
</section>
<section id="image-backend">
<h3>Image backend<a class="headerlink" href="#image-backend" title="Lien vers cette rubrique">¶</a></h3>
<p>Des images pré-construites automatiquement sont présentes sur <a class="reference external" href="https://github.com/PnX-SI/GeoNature/pkgs/container/geonature-backend/versions?filters%5Bversion_type%5D=tagged">Github</a>.</p>
<p>Les images tagguées <cite>-wheels</cite> contiennent les wheels Python de GeoNature, de ses dépendances et modules contrib, de manière à pouvoir être enrichies avec vos wheels provenant de vos propres modules (images de type « builder »).</p>
<p>Construction manuelle de l’image :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">DOCKER_BUILDKIT</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-f<span class="w"> </span>backend/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--target<span class="o">=</span>prod<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--tag<span class="o">=</span>ghcr.io/pnx-si/geonature-backend:develop
</pre></div>
</div>
<p>Fonctionnement de l’image :</p>
<ul class="simple">
<li><p>GeoNature attend sa configuration dans le dossier <code class="docutils literal notranslate"><span class="pre">/dist/config</span></code> (à monter dans un volume afin de pouvoir la modifier).
L’emplacement du fichier de configuration peut également être précisé via la variable d’environnement <code class="docutils literal notranslate"><span class="pre">GEONATURE_CONFIG_FILE</span></code>.</p></li>
<li><p>Il est également possible de fournir une configuration Python via la variable d’environnement <code class="docutils literal notranslate"><span class="pre">GEONATURE_SETTINGS</span></code>.</p></li>
<li><p>Les médias seront stockés dans le dossier <code class="docutils literal notranslate"><span class="pre">/dist/media</span></code> (à monter dans un volume afin de les sauvegarder).</p></li>
<li><p>Toute variable d’environnement préfixée par <code class="docutils literal notranslate"><span class="pre">GEONATURE_</span></code> se verra traduite par un paramètre de configuration homonyme
(<a class="reference external" href="https://flask.palletsprojects.com/en/2.2.x/api/#flask.Config.from_prefixed_env">documentation Flask</a>).
Si vous souhaitez définir une variable de configuration se trouvant dans une section, utilisez deux <em>underscore</em>.
Par exemple, pour définir le paramètre <code class="docutils literal notranslate"><span class="pre">NB_LAST_OBS</span></code> de la section <code class="docutils literal notranslate"><span class="pre">[SYNTHESE]</span></code>, on définira une variable d’environnement <code class="docutils literal notranslate"><span class="pre">GEONATURE_SYNTHESE__NB_LAST_OBS</span></code>.</p></li>
<li><p>Pour peupler la base de données, référez-vous au script <code class="docutils literal notranslate"><span class="pre">install/03_create_db.sh</span></code>.</p></li>
</ul>
</section>
<section id="image-frontend">
<h3>Image frontend<a class="headerlink" href="#image-frontend" title="Lien vers cette rubrique">¶</a></h3>
<p>Des images pré-construites automatiquement sont présentes sur <a class="reference external" href="https://github.com/PnX-SI/GeoNature/pkgs/container/geonature-frontend/versions?filters%5Bversion_type%5D=tagged">Github</a>.</p>
<p>Les images tagguées <cite>-source</cite> contiennent uniquement les sources de GeoNature et des modules contrib, et attendent d’être enrichies avec les sources de vos propres modules tandis que les images tagguées <cite>-nginx</cite> contiennent la configuration NGINX prête à l’emploi pour GeoNature (images de type « builder »).</p>
<p>Construction manuelle de l’image :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">DOCKER_BUILDKIT</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-f<span class="w"> </span>frontend/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--target<span class="o">=</span>prod<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--tag<span class="o">=</span>ghcr.io/pnx-si/geonature-frontend:develop
</pre></div>
</div>
<p>Fonctionnement de l’image :</p>
<ul class="simple">
<li><p>La configuration NGINX de l’image est générée dynamiquement à son démarrage, à partir des variables d’environnement suivantes :</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">NGINX_PORT</span></code> (défaut : 80)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NGINX_HOST</span></code> (défaut : localhost)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NGINX_LOCATION</span></code> (défaut : /, à modifier pour servir GeoNature sur un préfixe)</p></li>
</ul>
</li>
<li><p>La variable d’environnement <code class="docutils literal notranslate"><span class="pre">API_ENDPOINT</span></code> est lue au démarrage de l’image afin de mettre à jour le fichier de configuration du frontend <code class="docutils literal notranslate"><span class="pre">assets/config.json</span></code>.</p></li>
</ul>
</section>
</section>
<section id="https">
<h2>HTTPS<a class="headerlink" href="#https" title="Lien vers cette rubrique">¶</a></h2>
<p>Cette documentation est indicative car non-spécifique à GeoNature. Elle donne des indications sur la mise en place d’un certificat SSL pour une application web servie par Apache.</p>
<section id="utilisation-de-cerbot">
<h3>Utilisation de Cerbot<a class="headerlink" href="#utilisation-de-cerbot" title="Lien vers cette rubrique">¶</a></h3>
<p><strong>Source.</strong> <a class="reference external" href="https://korben.info/securiser-facilement-gratuitement-site-https.html">Sécuriser facilement et gratuitement un site avec HTTPS</a></p>
<p>La procédure décrit une méthode de certification HTTPS de votre domaine, grâce au service <a class="reference external" href="https://letsencrypt.org/">Let’s Encrypt</a>. Les manipulations ont été effectuées sur un serveur Debian 9 avec Apache2 installé, et un utilisateur bénéficiant des droits sudo.</p>
<p>Cerbot ne peut pas être utilisé pour la création d’un certificat sur une adresse IP (Exemple d’instances de test sans nom de domaine). Pour celà utiliser OpenSSL présenté rapidement ci-dessous.
Installation :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">certbot</span><span class="o">-</span><span class="n">apache</span>
</pre></div>
</div>
<p>Lancer la commande suivante pour générer des certificats et des clés pour le nom de domaine que vous souhaitez mettre en HTTPS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">certbot</span> <span class="o">--</span><span class="n">apache</span> <span class="o">--</span><span class="n">email</span> <span class="n">monemail</span><span class="nd">@mondomaine</span><span class="o">.</span><span class="n">fr</span>
</pre></div>
</div>
<p>Activer les modules <code class="docutils literal notranslate"><span class="pre">ssl</span></code>, <code class="docutils literal notranslate"><span class="pre">headers</span></code> et <code class="docutils literal notranslate"><span class="pre">rewrite</span></code> puis redémarrer Apache :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">ssl</span>
<span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">rewrite</span>
<span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">headers</span>
<span class="n">sudo</span> <span class="n">apachectl</span> <span class="n">restart</span>
</pre></div>
</div>
<p>Les fichiers de configuration du site UsersHub n’est pas à modifier, il sera automatiquement associé à la configuration HTTPS. En revanche, la configuration de GeoNature doit être mise à jour.</p>
</section>
<section id="utilisation-de-openssl-sur-un-environnement-de-test">
<h3>Utilisation de OpenSSL sur un environnement de test<a class="headerlink" href="#utilisation-de-openssl-sur-un-environnement-de-test" title="Lien vers cette rubrique">¶</a></h3>
<p>Cette procédure a été testée sur Debian 12 et Apache2 avec l’utilisation d’un certificat auto-signé. Cela signifie qu’une alerte sera envoyée aux navigateurs indiquant un manque de sécurisation du serveur.
Cette méthode fonctionne avec un serveur sans nom de domaine.</p>
<p>Création d’un nouveau certificat de 365 jours (30 jours par défaut), de type X509 avec l’emplacement des fichiers de certificat et de clé privé.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-x509<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-nodes<span class="w"> </span>-out<span class="w"> </span>/etc/ssl/certs/mailserver.crt<span class="w"> </span>-keyout<span class="w"> </span>/etc/ssl/private/mailserver.key
</pre></div>
</div>
<p>Sécurisation de la clé</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">440</span><span class="w"> </span>/etc/ssl/private/mailserver.key
</pre></div>
</div>
<p>Chargement du module ssl dans Apache</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>a2enmod<span class="w"> </span>ssl
</pre></div>
</div>
<p>Modification de la configuration du VirtualHost en éditant le fichier <code class="docutils literal notranslate"><span class="pre">/etc/apache2/sites-available/geonature.conf</span></code></p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="s">*:443</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nb">ServerName</span><span class="w"> </span>x.x.x.x
<span class="w">    </span><span class="err">[…]</span>
<span class="w">    </span><span class="nb">SSLEngine</span><span class="w"> </span><span class="k">on</span>
<span class="w">    </span><span class="nb">SSLCertificateFile</span><span class="w"> </span><span class="sx">/etc/ssl/certs/mailserver.crt</span>
<span class="w">    </span><span class="nb">SSLCertificateKeyFile</span><span class="w"> </span><span class="sx">/etc/ssl/private/mailserver.key</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apachectl</span> <span class="n">restart</span>
</pre></div>
</div>
</section>
<section id="configuration-de-l-application-geonature">
<h3>Configuration de l’application GeoNature<a class="headerlink" href="#configuration-de-l-application-geonature" title="Lien vers cette rubrique">¶</a></h3>
<p>Il est nécessaire de mettre à jour le fichier de configuration <code class="docutils literal notranslate"><span class="pre">geonature_config.toml</span></code> situé dans le répertoire <code class="docutils literal notranslate"><span class="pre">geonature/config</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">geonature</span><span class="o">/</span><span class="n">config</span>
<span class="n">nano</span> <span class="n">geonature_config</span><span class="o">.</span><span class="n">toml</span>
</pre></div>
</div>
<p>Modifier les éléments suivants :</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">URL_APPLICATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://mondomaine.fr/geonature&#39;</span>
<span class="n">API_ENDPOINT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://mondomaine.fr/geonature/api&#39;</span>
</pre></div>
</div>
<p>Pour que ces modifications soient prises en compte, exécuter les <a class="reference internal" href="admin-manual.html#post-config-change"><span class="std std-ref">actions à effecture après modification de la configuration</span></a>.</p>
<p>Les applications sont désormais accessibles sur votre domaine sécurisé en HTTPS !</p>
</section>
</section>
<section id="taches-planifiees">
<span id="cron"></span><h2>Taches planifiées<a class="headerlink" href="#taches-planifiees" title="Lien vers cette rubrique">¶</a></h2>
<p>Depuis sa version 2.12.0, les taches planifiées gérées par des crons ont été remplacées par des taches lancées automatiquement par Celery Beat, pour être mis en place automatiquement lors de l’installation de GeoNature et être plus facilement administrables.</p>
</section>
<section id="installation-d-un-module-geonature">
<span id="install-gn-module"></span><h2>Installation d’un module GeoNature<a class="headerlink" href="#installation-d-un-module-geonature" title="Lien vers cette rubrique">¶</a></h2>
<p>L’installation de GeoNature n’est livrée qu’avec les modules du coeur par défaut : Occtax, Occhab et Validation. Pour ajouter un module GeoNature externe, il est nécessaire de l’installer :</p>
<section id="id4">
<h3>Téléchargement<a class="headerlink" href="#id4" title="Lien vers cette rubrique">¶</a></h3>
<p>Téléchargez le module depuis son dépôt Github puis dézippez-le dans le repertoire utilisateur, au même niveau que le dossier de GeoNature.</p>
</section>
<section id="installation-automatique">
<span id="install-gn-module-auto"></span><h3>Installation automatique<a class="headerlink" href="#installation-automatique" title="Lien vers cette rubrique">¶</a></h3>
<p>Installation avec la sous-commande <code class="docutils literal notranslate"><span class="pre">install-gn-module</span></code> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>&lt;dossier<span class="w"> </span>GeoNature&gt;/backend/venv/bin/activate
geonature<span class="w"> </span>install-gn-module<span class="w"> </span>&lt;dossier<span class="w"> </span>du<span class="w"> </span>module&gt;<span class="w"> </span>&lt;code<span class="w"> </span>du<span class="w"> </span>module&gt;
</pre></div>
</div>
<p>Exemple pour le module Import :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/GeoNature/backend/venv/bin/activate
geonature<span class="w"> </span>install-gn-module<span class="w"> </span>~/gn_module_import/<span class="w"> </span>IMPORT
</pre></div>
</div>
<p>Puis relancer GeoNature et son worker :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature-worker
</pre></div>
</div>
<p>Aucune permission n’est définie par défaut lors de l’installation d’un module. En tant qu’administrateur, vous pouvez exécuter une commande ajoutant tous les droits sur tous les modules à un groupe ou utilisateur. Cette commande peut être relancée après l’installation d’un module pour automatiquement attribuer toutes les permissions à un groupe ou utilisateur administrateur :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># changer &quot;Grp_Admin&quot; par le nom de votre groupe d&#39;administrateur si vous l&#39;avez changé</span>
geonature<span class="w"> </span>permissions<span class="w"> </span>supergrant<span class="w"> </span>--group<span class="w"> </span>--nom<span class="w"> </span><span class="s2">&quot;Grp_admin&quot;</span>
</pre></div>
</div>
<p>Vous devrez ensuite définir des droits à vos utilisateurs pour le nouveau module installé.</p>
</section>
<section id="installation-manuelle">
<h3>Installation manuelle<a class="headerlink" href="#installation-manuelle" title="Lien vers cette rubrique">¶</a></h3>
<p><strong>Installation du backend</strong></p>
<p>Installer le module avec <code class="docutils literal notranslate"><span class="pre">pip</span></code> en mode éditable après avoir activé le venv de GeoNature, puis relancer GeoNature :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/geonature/backend/venv/bin/activate
pip<span class="w"> </span>install<span class="w"> </span>--editable<span class="w"> </span>&lt;dossier<span class="w"> </span>du<span class="w"> </span>module&gt;
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature
</pre></div>
</div>
<p id="module-install-frontend"><strong>Installation du frontend</strong></p>
<ul>
<li><p>Créer un lien symbolique dans le dossier <code class="docutils literal notranslate"><span class="pre">frontend/external_modules</span></code> de GeoNature vers le dossier <code class="docutils literal notranslate"><span class="pre">frontend</span></code> du module.
Le lien symbolique doit être nommé suivant le code du module en minuscule :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/geonature/frontend/external_modules/
ln<span class="w"> </span>-s<span class="w"> </span>&lt;dossier<span class="w"> </span>du<span class="w"> </span>module&gt;/frontend<span class="w"> </span>&lt;code<span class="w"> </span>du<span class="w"> </span>module<span class="w"> </span>en<span class="w"> </span>minuscule&gt;
</pre></div>
</div>
<p>Exemple pour le module Import :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/geonature/frontend/external_modules/
ln<span class="w"> </span>-s<span class="w"> </span>~/gn_module_import/frontend<span class="w"> </span>import
</pre></div>
</div>
</li>
<li><p>Re-builder le frontend :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/geonature/frontend/
nvm<span class="w"> </span>use
npm<span class="w"> </span>run<span class="w"> </span>build
</pre></div>
</div>
</li>
</ul>
<p><strong>Installation de la base de données</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>~/geonature/backend/venv/bin/activate
geonature<span class="w"> </span>upgrade-modules-db<span class="w"> </span>&lt;code<span class="w"> </span>du<span class="w"> </span>module&gt;
</pre></div>
</div>
</section>
<section id="configuration-du-module">
<span id="module-config"></span><h3>Configuration du module<a class="headerlink" href="#configuration-du-module" title="Lien vers cette rubrique">¶</a></h3>
<p>De manière facultative, vous pouvez modifier la configuration du module.
Pour cela, vous pouvez créer un fichier de configuration dans le dossier <code class="docutils literal notranslate"><span class="pre">config</span></code> de GeoNature en le nommant <code class="docutils literal notranslate"><span class="pre">&lt;code</span> <span class="pre">du</span> <span class="pre">module</span> <span class="pre">en</span> <span class="pre">minuscule&gt;_config.toml</span></code>.
La plupart des modules fournissent un fichier d’exemple <code class="docutils literal notranslate"><span class="pre">&lt;module-code&gt;_config.toml.example</span></code> dans leur dossier racine dont vous pouvez vous inspirer.</p>
<p>Après création de ce fichier, activez le rechargement automatique de GeoNature lors des modifications du fichier en lançant les commandes suivantes :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>geonature
</pre></div>
</div>
<p>Avant la version 2.12.0 de GeoNature, après chaque modification de la configuration du module, vous devez recharger GeoNature manuellement :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>geonature
</pre></div>
</div>
</section>
<section id="mise-a-jour-du-module">
<h3>Mise à jour du module<a class="headerlink" href="#mise-a-jour-du-module" title="Lien vers cette rubrique">¶</a></h3>
<ul class="simple">
<li><p>Déplacer le code de l’ancienne version du module : <code class="docutils literal notranslate"><span class="pre">mv</span> <span class="pre">gn_module_xxx</span> <span class="pre">gn_module_xxx_old</span></code></p></li>
<li><p>Télécharger et désarchiver la nouvelle version du module, et renommer son dossier afin qu’il porte le même nom qu’avant (<em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">gn_module_xxx</span></code>)</p></li>
<li><p>(Optionnel) Si le fichier de configuration du module est encore placé avec celui-ci, le déplacer dans la dossier de configuration centralisée de GeoNature : <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">gn_module_xxx_old/config/conf_gn_module.toml</span> <span class="pre">geonature/config/&lt;mode-code&gt;_config.toml</span></code></p></li>
<li><p>Relancer l’<a class="reference internal" href="#install-gn-module-auto"><span class="std std-ref">installation du module</span></a> : <code class="docutils literal notranslate"><span class="pre">geonature</span> <span class="pre">install-gn-module</span> <span class="pre">gn_module_xxx</span> <span class="pre">XXX</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">systemctl</span> <span class="pre">reload</span> <span class="pre">geonature</span></code></p></li>
</ul>
</section>
</section>
<section id="mise-a-jour-de-l-application">
<h2>Mise à jour de l’application<a class="headerlink" href="#mise-a-jour-de-l-application" title="Lien vers cette rubrique">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Avant chaque mise à jour de GeoNature, il est important de sauvegarder l’application et sa base de données, ou de faire un snapshot du serveur pour pouvoir revenir à son état antérieure avant mise à jour, en cas de problème.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Vérifiez préalablement la compatibilité des modules que vous utilisez avant de mettre GeoNature à jour.
S’il est nécessaire de les mettre à jour, arrêtez vous après le remplacement du dossier par le nouveau code source
(et la récupération éventuelle de la configuration); le script de migration de GeoNature s’occupera automatiquement
d’installer la nouvelle version du module.</p>
</div>
<p>La mise à jour de GeoNature consiste à télécharger sa nouvelle version dans un nouveau répertoire, récupérer les fichiers de configuration et de surcouche, ainsi que les médias depuis la version actuelle et de relancer l’installation dans le répertoire de la nouvelle version.</p>
<p>La mise à jour doit être réalisée avec votre utilisateur linux courant (<code class="docutils literal notranslate"><span class="pre">geonatureadmin</span></code> par exemple) et non pas le super-utilisateur <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<ul>
<li><p>Télécharger la dernière version de GeoNature :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/PnX-SI/GeoNature/archive/X.Y.Z.zip
unzip<span class="w"> </span>X.Y.Z.zip
rm<span class="w"> </span>X.Y.Z.zip
</pre></div>
</div>
</li>
<li><p>Renommer l’ancien repertoire de l’application, ainsi que le nouveau :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv<span class="w"> </span>~/geonature/<span class="w"> </span>~/geonature_old/
mv<span class="w"> </span>~/GeoNature-X.Y.Z<span class="w"> </span>~/geonature/
<span class="nb">cd</span><span class="w"> </span>~/geonature
</pre></div>
</div>
</li>
<li><p>Suivez les éventuelles notes de version spécifiques décrites au niveau de chaque version : <a class="reference external" href="https://github.com/PnX-SI/GeoNature/releases">https://github.com/PnX-SI/GeoNature/releases</a>.</p></li>
</ul>
<p>Sauf mentions contraires dans les notes de version, vous pouvez sauter des versions mais en suivant bien les différentes notes de versions intermédiaires.</p>
<ul>
<li><p>Si vous devez aussi mettre à jour UsersHub, suivez ses notes de version et sa documentation (<a class="reference external" href="https://usershub.readthedocs.io">https://usershub.readthedocs.io</a>).</p></li>
<li><p>Lancez le script de <code class="docutils literal notranslate"><span class="pre">migration.sh</span></code> à la racine du dossier <code class="docutils literal notranslate"><span class="pre">geonature</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./install/migration/migration.sh<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>install/migration/migration.log
</pre></div>
</div>
</li>
</ul>
<p>Depuis la version 2.12, le script <cite>migration.sh</cite> peut prendre en argument le chemin vers l’ancien dossier d’installation de GeoNature. Il peut s’agir du même dossier que la nouvelle installation de GeoNature. Cela permet d’utiliser ce script si la nouvelle version de GeoNature est dans le même dossier et donc de gérer le cas où GeoNature est installé et mis à jour avec git.</p>
<p>Dans ce cas, les commandes à exécuter sont :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/GeoNature
git<span class="w"> </span>status<span class="w"> </span><span class="c1"># optionnel, pour connaitre l&#39;état et la version ou branche actuellement utilisée</span>
git<span class="w"> </span>fetch
git<span class="w"> </span>checkout<span class="w"> </span>X.Y.Z<span class="w"> </span><span class="c1"># où X.Y.Z est le numéro du tag de la version vers laquelle faire la mise à jour, ou le nom de la branche à utiliser</span>
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span><span class="c1"># ou &quot;git config submodule.recurse true&quot; lancé une seule fois, pour que la mise à jour des sous-modules soit relancée automatiquement à chaque &quot;git pull&quot;</span>
./install/migration/migration.sh<span class="w"> </span>.
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="user-manual.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Manuel utilisateur</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2018-2024, Parc National des Écrins, Parc National des Cévennes
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#prerequis">Prérequis</a></li>
<li><a class="reference internal" href="#preparation-du-serveur">Préparation du serveur</a></li>
<li><a class="reference internal" href="#installation-globale">Installation globale</a><ul>
<li><a class="reference internal" href="#installation-des-applications">Installation des applications</a><ul>
<li><a class="reference internal" href="#telechargement">Téléchargement</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#id1">Installation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installation-de-geonature-uniquement">Installation de GeoNature uniquement</a><ul>
<li><a class="reference internal" href="#installation-des-dependances">Installation des dépendances</a></li>
<li><a class="reference internal" href="#recuperation-de-l-application">Récupération de l’application</a></li>
<li><a class="reference internal" href="#installation-de-l-application">Installation de l’application</a></li>
<li><a class="reference internal" href="#configuration-apache">Configuration Apache</a></li>
<li><a class="reference internal" href="#dependances">Dépendances</a></li>
<li><a class="reference internal" href="#passer-en-mode-developpement">Passer en mode développement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#docker">Docker</a><ul>
<li><a class="reference internal" href="#docker-compose">Docker Compose</a></li>
<li><a class="reference internal" href="#image-backend">Image backend</a></li>
<li><a class="reference internal" href="#image-frontend">Image frontend</a></li>
</ul>
</li>
<li><a class="reference internal" href="#https">HTTPS</a><ul>
<li><a class="reference internal" href="#utilisation-de-cerbot">Utilisation de Cerbot</a></li>
<li><a class="reference internal" href="#utilisation-de-openssl-sur-un-environnement-de-test">Utilisation de OpenSSL sur un environnement de test</a></li>
<li><a class="reference internal" href="#configuration-de-l-application-geonature">Configuration de l’application GeoNature</a></li>
</ul>
</li>
<li><a class="reference internal" href="#taches-planifiees">Taches planifiées</a></li>
<li><a class="reference internal" href="#installation-d-un-module-geonature">Installation d’un module GeoNature</a><ul>
<li><a class="reference internal" href="#id4">Téléchargement</a></li>
<li><a class="reference internal" href="#installation-automatique">Installation automatique</a></li>
<li><a class="reference internal" href="#installation-manuelle">Installation manuelle</a></li>
<li><a class="reference internal" href="#configuration-du-module">Configuration du module</a></li>
<li><a class="reference internal" href="#mise-a-jour-du-module">Mise à jour du module</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mise-a-jour-de-l-application">Mise à jour de l’application</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=7e9e99ef"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/translations.js?v=041d0952"></script>
    </body>
</html>