<div
  *ngIf="!field.autogenerated"
  class="form-group"
>
  <small>
    {{ field.fr_label }} :
    <i
      *ngIf="field.comment"
      matTooltip="{{ field.comment }}"
      matTooltipClass="custom-tooltip"
      class="fa fa-info-circle"
      aria-hidden="true"
    ></i>
  </small>
  <div class="InputFieldContainer">
    <ng-select
      [hidden]="inputState != InputStackState.INPUT_FILE"
      id="{{ field.name_field }}"
      [items]="csvColumnNames"
      [(ngModel)]="csvColumn"
      [multiple]="field.multi"
      [clearable]="true"
      [virtualScroll]="true"
      [attr.data-qa]="'import-fieldmapping-theme-' + field.name_field"
    >
      <ng-template
        ng-option-tmp
        let-item="item"
        let-index="index"
        let-search="searchTerm"
      >
        <div>
          <span
            class="pre-wrap CSVColumnList__item"
            [ngClass]="{
              'CSVColumnList__item--used': fm.checkTargetFieldStatus('mapped', item)
            }"
          >
            {{ item }}
          </span>
        </div>
      </ng-template>
    </ng-select>
    <gn-dynamic-form-wrapper
      [hidden]="inputState != InputStackState.CONSTANT"
      [field]="field"
      [value]="constantValue"
      (valueEdit)="constantValueEdited($event)"
    />
    <button
      mat-stroked-button
      class="InputFieldContainer__button"
      (click)="switchInputType()"
      [ngClass]="{
        'InputFieldContainer__button--selected': inputState == InputStackState.CONSTANT
      }"
      [attr.data-qa]="'import-fieldmapping-theme-switch-' + field.name_field"
    >
      <mat-icon>edit</mat-icon>
      Saisie manuelle
    </button>
  </div>

  <div
    *ngIf="!isCsvColumnValid"
    class="invalid-feedback warning-feedback d-block"
  >
    {{ csvColumnValidityMessage }}
  </div>

  <div
    class="d-flex flex-column"
    *ngIf="formGroup.controls[field.name_field]?.errors?.required"
  >
    <strong class="invalid-feedback d-inline">
      Veuillez renseigner le champs "{{ field.fr_label }}"
    </strong>

    <small
      *ngIf="field.optional_conditions"
      class="d-inline hint-condition"
    >
      {{ 'Import.FieldMapping.OptionalIf' | translate }}
      ({{ optionalFieldLabels.join(', ') }})
      {{ field.optional_conditions.length > 1 ? 'sont renseignées' : 'est renseignée' }}
    </small>
  </div>

  <ng-container
    *ngIf="!formGroup.controls[field.name_field]?.errors?.required && field.mandatory_conditions"
  >
    <small class="hint-condition">
      {{ 'Import.FieldMapping.RequiredIf' | translate }}
      ({{ mandatoryFieldLabels.join(', ') }})
      {{ field.mandatory_conditions?.length > 1 ? 'sont renseignées' : 'est renseignée' }}
    </small>
  </ng-container>

  <div
    *ngIf="formGroup.controls[field.name_field]?.hasError('conflict')"
    class="invalid-feedback d-block"
  >
    {{ formGroup.controls[field.name_field].getError('conflict') }}
  </div>
</div>
<div
  *ngIf="field.autogenerated"
  class="form-group"
  [attr.data-qa]="'import-fieldmapping-theme-' + field.name_field"
>
  <div>
    <label for="{{ field.name_field }}">
      <small>{{ field.fr_label }} :</small>
    </label>
    <input
      class="ml-1"
      type="checkbox"
      id="{{ field.name_field }}"
      [(ngModel)]="sinpGenerate"
    />
  </div>
  <div>
    <small *ngIf="shouldDisplaySINPGenerateAlert">
      <strong class="text-warning">
        {{ 'Import.FieldMapping.SinpUUIDWarning' | translate }}
      </strong>
    </small>
  </div>
</div>
